# Task 1 - Install dotnet pre-requisites

- [dotnet 7.0](https://learn.microsoft.com/en-us/dotnet/core/install/linux-ubuntu#2004)

```
wget https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
sudo dpkg -i packages-microsoft-prod.deb
rm packages-microsoft-prod.deb
sudo apt-get update
sudo apt-get install -y aspnetcore-runtime-7.0
```

# Task 2 - Containerize the application

## Download the sample app

```
git clone https://github.com/dotnet/dotnet-docker
```

## Execute the .NET application

```
cd ~/dotnet-docker/samples/aspnetapp/aspnetapp
dotnet run
```

Web App is listening on http://localhost:5011
Press Ctrl+C at the command prompt to stop the app.

```
Building...
warn: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[35]
      No XML encryptor configured. Key {7f537284-4d68-438e-ba7c-bdd5fa14835d} may be persisted to storage in unencrypted form.
info: Microsoft.Hosting.Lifetime[14]
      Now listening on: http://localhost:5011
info: Microsoft.Hosting.Lifetime[0]
      Application started. Press Ctrl+C to shut down.
```

## Review the project configuration

The project is using .net 7.0

vi ~/dotnet-docker/samples/aspnetapp/aspnetapp/aspnetapp.csproj
```
<Project Sdk="Microsoft.NET.Sdk.Web">
  <PropertyGroup>
    <TargetFramework>net7.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <UserSecretsId>57393389627611478466</UserSecretsId>
  </PropertyGroup>

</Project>
```

## Review the Dockerfile build instructions

vi ~/dotnet-docker/samples/aspnetapp

```Dockerfile
# https://hub.docker.com/_/microsoft-dotnet
FROM mcr.microsoft.com/dotnet/sdk:7.0 AS build
WORKDIR /source

# copy csproj and restore as distinct layers
COPY aspnetapp/*.csproj .
RUN dotnet restore --use-current-runtime

# copy everything else and build app
COPY aspnetapp/. .
RUN dotnet publish -c Release -o /app --use-current-runtime --self-contained false --no-restore

# final stage/image
FROM mcr.microsoft.com/dotnet/aspnet:7.0
WORKDIR /app
COPY --from=build /app .
ENTRYPOINT ["dotnet", "aspnetapp.dll"]
```

