# Azure File Share

- [Azure File Share](https://learn.microsoft.com/en-us/azure/storage/files/storage-files-quick-create-use-linux)
- [Azure Files NFS mounted on Azure Kubernetes Service](https://blog.nillsf.com/index.php/2021/01/11/azure-files-nfs-mounted-on-azure-kubernetes-service/)

## Task 1 - Azure files NFS

Create NFS export

```
az login

rg_st="RG-myaks-storage"
location="westeurope"
stacc="aksmyst$RANDOM"
share="export"

az group create \
    --name $rg_st \
    --location $location \
    --output none
    
az storage account create \
    --resource-group $rg_st \
    --name $stacc \
    --location $location \
    --kind FileStorage \
    --sku Premium_LRS \
    --enable-large-file-share \
    --output none
    
az storage share-rm create \
    --resource-group $rg_st \
    --storage-account $stacc \
    --name $share \
    --root-squash RootSquash \
    --quota 1024 \
    --enabled-protocols NFS \
    --output none
    
az storage account update --https-only false \
 --name $stacc --resource-group $rg_st
```
 
 
 # Task 2 - Private Endpoint
 
 - Enter the storage account and select File Shares
 - Select "Export" file share and then "Configure Netwrok Security -- > Setup a private endpoint"
 - Add Private Endpoint : RG = "RG-aksmyst" , Name="aksmystep" , Region=westeurope"
 - Resource="file"
 - Virtual Network="MC_RG-myAKS_myAKSCluster_westeurope", subnet ="aks_subnet", Dynamic IP
 - Integrate with private DNS zone="Yes"
 
 # Task 3 - Secure Transfer Disable
 
 - Storage Account --> File Shares -> Export -> Secure transfer setting="Disable"
